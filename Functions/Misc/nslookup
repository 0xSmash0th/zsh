# Simple wrapper function for `nslookup'. With completion if you are using
# the function based completion system.

setopt localoptions localtraps completealiases

local tmp line compcontext=nslookup curcontext=':nslookup' pmpt

trap 'return 130' INT
trap 'zpty -d nslookup' EXIT

zstyle -s ':nslookup' prompt pmpt || pmpt='> '

zpty nslookup nslookup

zpty -r nslookup line '*> '
print -nr "$line"

while line=''; vared -p "$pmpt" line; do
  [[ "$line" = exit ]] && break

  zpty -w nslookup "$line"

  zpty -r nslookup line '*> '
  print -nr "$line"
done

zpty -w nslookup 'exit'
