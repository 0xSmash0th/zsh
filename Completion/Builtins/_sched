#compdef sched

local expl lines disp

if [[ CURRENT -eq 2 ]]; then
  if compset -P -; then
    _wanted -C - entries expl 'scheduled jobs' || return 1

    lines=(${(f)"$(sched)"})
    if _style entries description; then
      disp=( -ld lines )
    else
      disp=()
    fi
    [[ -z $lines ]] || compadd "$expl[@]" "$disp[@]" - {1..$#lines}
  else
    _message 'time specification'
    return 1
  fi
fi
compset -n 3 && _normal
