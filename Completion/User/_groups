#compdef newgrp

local expl groups tmp

_wanted groups || return 1

if ! zstyle -a ":completion:${curcontext}:" groups groups; then
  (( $+_cache_groups )) ||
      if (( ${+commands[ypcat]} )) && tmp=$(ypcat group.byname); then
        : ${(A)_cache_groups:=${${(f)tmp}%%:*}} # If you use YP
      else
        : ${(A)_cache_groups:=${${(s: :)$(</etc/group)}%%:*}}
      fi

  groups=( "$_cache_groups[@]" )
fi

_loop groups expl group compadd "$@" - "$groups[@]"
